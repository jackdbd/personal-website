---
layout: page.njk
---
{%- block content %}

<article class="prose flow region h-entry">

  <div class="flow e-content">{{ content | safe }}</div>

  {% if location %}
    <pre>{{ location | dump | safe }}</pre>
  {% endif %}

  {# photo can be: a single URL, an object with alt+value, or an array of those things #}
  {# {% if photo %}
    <p>TODO: add photo component</p>
  {% endif %} #}

  {# video can be: a single URL, an array of URLs #}
  {# {% if video %}
    <p>TODO: add video component</p>
  {% endif %} #}

  {# audio can be: a single URL, an array of URLs #}
  {# {% if audio %}
    <figure class="h-entry">
      <audio controls src="https://content.giacomodebidda.com/media/example_700KB.mp3"></audio>
      <a href="https://content.giacomodebidda.com/media/example_700KB.mp3"
        >Download audio</a
      >
      <figcaption>
        <p class="p-content">A test audio file.</p>
      </figcaption>
    </figure>
  {% endif %} #}

  <p>Published on: <time class="dt-published" datetime="{{ date }}">{{ date }}</time></p>

  {% if mpSyndicateTo and mpSyndicateTo | length > 0 %}
    <p>mp-syndicate-to</p>
    <ul>
      {%- for uid in mpSyndicateTo %}
        <li><a href="{{ uid }}">{{ uid }}</a></li>
      {% endfor -%}
    </ul>
  {% endif %}

  {% if syndication and syndication | length > 0 %}
    <p>syndication</p>
    <ul>
      {%- for href in syndication %}
        <li><a href="{{ href }}">{{ href }}</a></li>
      {% endfor -%}
    </ul>
  {% endif %}

  {% if tags and tags | length > 0 %}
    {% set align = "end" %}
    {% include "components/tags.njk" %}
  {% endif %}

</article>

{% set likes = webmentionsReceivedAtURL | getWebmentionsByTypes(['like-of']) %}
{% set replies = webmentionsReceivedAtURL | getWebmentionsByTypes(['mention-of', 'in-reply-to', 'reply']) %}
{% set reposts = webmentionsReceivedAtURL | getWebmentionsByTypes(['repost-of']) %}

{# Global data #}
{# {{ webmentions | log }} #}

{# Computed Data #}
{# {{ webmentionsReceivedAtURL | log }} #}
{# {{ webmentionTargetURL | log }} #}

{% renderTemplate "webc", {
  likes: likes,
  replies: replies,
  reposts: reposts,
  webmention_endpoint: webmentions.webmention_endpoint,
  webmention_target_url: webmentionTargetURL } %}
<webmentions-section
  :@likes="likes"
  :@replies="replies"
  :@reposts="reposts"
  :@webmention-endpoint="webmention_endpoint"
  :@webmention-target-url="webmention_target_url">
</webmentions-section>
{% endrenderTemplate %}

<p>See <a href="/notes">all notes</a>.</p>

{% endblock content -%}
